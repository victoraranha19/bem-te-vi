{
	"$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
	"name": "Bem-Te-Vi",
	"scopeName": "source.btv",
	"patterns": [
		{
			"include": "#comments"
		},
		{
			"include": "#programa"
		}
	],
	"repository": {
		"tipo_primitivo": {
			"match": "\\b(Bool|Numero|Texto)\\b",
			"name": "keyword.tipo.primitivo.btv"
		},
		"programa": {
			"patterns": [
				{
					"include": "#familia"
				},
				{
					"include": "#def_molde"
				}
			]
		},
		"familia": {
			"patterns": [
				{
					"match": "(;|\\.)",
					"name": "punctuation.familia.btv"
				},
				{
					"include": "#relacao"
				}
			]
		},
		"relacao": {
			"patterns": [
				{
					"match": "\\b(molde|se\\s+passa\\s+por)\\b",
					"name": "keyword.relacao.btv"
				},
				{
					"include": "#id_molde"
				}
			]
		},
		"def_molde": {
			"patterns": [
				{
					"match": "\\b(molde|contem|fim)\\b",
					"name": "keyword.def.molde.btv"
				},
				{
					"include": "#id_molde"
				},
				{
					"include": "#atributos"
				},
				{
					"include": "#metodos"
				}
			]
		},
		"atributos": {
			"patterns": [
				{
					"include": "#dec_cons"
				},
				{
					"include": "#dec_obj"
				}
			]
		},
		"metodos": {
			"patterns": [
				{
					"include": "#dec_funcao"
				}
			]
		},
		"dec_cons": {
			"patterns": [
				{
					"match": "\\b(constante)\\b",
					"name": "keyword.dec.molde.btv"
				},
				{
					"match": "(:|;)",
					"name": "punctuation.dec.btv"
				},
				{
					"include": "#tipo_primitivo"
				},
				{
					"include": "#id"
				}
			]
		},
		"dec_obj": {
			"patterns": [
				{
					"match": "\\b(objeto)\\b",
					"name": "keyword.dec.molde.btv"
				},
				{
					"match": "(:|;)",
					"name": "punctuation.dec.btv"
				},
				{
					"include": "#tipo_molde"
				},
				{
					"include": "#id"
				}
			]
		},
		"tipo_molde": {
			"patterns": [
				{
					"include": "#id_molde"
				}
			]
		},
		"tipo": {
			"patterns": [
				{
					"include": "#tipo_molde"
				},
				{
					"include": "#tipo_primitivo"
				}
			]
		},
		"dec_funcao": {
			"patterns": [
				{
					"match": "\\b(funcao)\\b",
					"name": "keyword.dec.molde.btv"
				},
				{
					"match": "(>>|:|;)",
					"name": "punctuation.dec.btv"
				},
				{
					"match": "(\\(|\\))",
					"name": "punctuation.dec.btv"
				},
				{
					"include": "#tipo"
				},
				{
					"include": "#parametros"
				},
				{
					"include": "#bloco"
				},
				{
					"include": "#id"
				}
			]
		},
		"parametros": {
			"patterns": [
				{
					"match": "(\\|)",
					"name": "punctuation.parametros.btv"
				},
				{
					"include": "#parametro"
				}
			]
		},
		"parametro": {
			"patterns": [
				{
					"include": "#tipo"
				},
				{
					"include": "#assinatura"
				},
				{
					"include": "#id"
				}
			]
		},
		"assinatura": {
			"patterns": [
				{
					"match": "(\\(|\\))",
					"name": "punctuation.assinatura.btv"
				},
				{
					"include": "#tipo"
				},
				{
					"include": "#parametros_assinatura"
				},
				{
					"include": "#id"
				}
			]
		},
		"parametros_assinatura": {
			"patterns": [
				{
					"match": "(\\|)",
					"name": "punctuation.parametros.btv"
				},
				{
					"include": "#parametro_assinatura"
				}
			]
		},
		"parametro_assinatura": {
			"patterns": [
				{
					"include": "#tipo"
				},
				{
					"include": "#assinatura"
				},
				{
					"include": "#id"
				}
			]
		},
		"bloco": {
			"patterns": [
				{
					"match": "\\b(\\[|\\])\\b",
					"name": "punctuation.bloco.btv"
				},
				{
					"include": "#dec_cons"
				},
				{
					"include": "#dec_obj"
				},
				{
					"include": "#definicao"
				},
				{
					"include": "#exp"
				}
			]
		},
		"definicao": {
			"patterns": [
				{
					"match": "\\b(\\=|;)\\b",
					"name": "punctuation.definicao.btv"
				},
				{
					"include": "#atributo"
				},
				{
					"include": "#id"
				},
				{
					"include": "#exp"
				}
			]
		},
		"atributo": {
			"patterns": [
				{
					"match": "\\b(\\.)\\b",
					"name": "punctuation.atributo.btv"
				},
				{
					"include": "#id"
				}
			]
		},
		"exp": {
			"patterns": [
				{
					"match": "\\b(\\(|\\)|\\+|\\-|\\*|\\/|%|\\=\\=|\\<|\\<\\=|!)\\b",
					"name": "punctuation.exp.btv"
				},
				{
					"match": "\\b(verdade|falso|se|entao|senao|e|ou)\\b",
					"name": "keyword.exp.btv"
				},
				{
					"include": "#bloco"
				},
				{
					"include": "#instancia"
				},
				{
					"include": "#chamada"
				},
				{
					"include": "#atributo"
				},
				{
					"include": "#valor_numero"
				},
				{
					"include": "#valor_texto"
				},
				{
					"include": "#id"
				}
			]
		},
		"instancia": {
			"patterns": [
				{
					"match": "\\b(\\[|\\])\\b",
					"name": "punctuation.instancia.btv"
				},
				{
					"include": "#lista_inicializacao"
				},
				{
					"include": "#id_molde"
				}
			]
		},
		"lista_inicializacao": {
			"patterns": [
				{
					"match": "\\b(\\|)\\b",
					"name": "punctuation.lista.inicializacao.btv"
				},
				{
					"include": "#inicializacao_objeto"
				}
			]
		},
		"inicializacao_objeto": {
			"patterns": [
				{
					"match": "\\b(\\.|\\=)\\b",
					"name": "punctuation.inicializacao.btv"
				},
				{
					"match": "\\b(objeto)\\b",
					"name": "keyword.inicializacao.btv"
				},
				{
					"include": "#exp"
				},
				{
					"include": "#id"
				}
			]
		},
		"chamada": {
			"patterns": [
				{
					"match": "\\b(\\.|\\(|\\))\\b",
					"name": "punctuation.chamada.btv"
				},
				{
					"include": "#lista_exp"
				},
				{
					"include": "#id"
				}
			]
		},
		"lista_exp": {
			"patterns": [
				{
					"match": "\\b(\\|)\\b",
					"name": "punctuation.lista.exp.btv"
				},
				{
					"include": "#exp"
				}
			]
		},
		"valor_texto": {
			"patterns": [
				{
					"begin": "\"",
					"beginCaptures": {
						"0": {
							"name": "punctuation.definition.string.begin.btv"
						}
					},
					"end": "\"",
					"endCaptures": {
						"0": {
							"name": "punctuation.definition.string.end.btv"
						}
					},
					"name": "string.quoted.double.btv",
					"patterns": [
						{
							"match": "\\\\.",
							"name": "constant.character.escape.btv"
						}
					]
				}
			]
		},
		"valor_numero": {
			"match": "(?x)(?<!\\$) ( \\b\\d+?,\\B(?!,) | \\b\\d+?,[Ee][+-]?\\d+\\b | \\b\\d+,([Ee][+-]?\\d+)?\\b | \\b\\d+,\\d+([Ee][+-]?\\d+)?\\b | (?<!,)\\B,\\d+([Ee][+-]?\\d+)?\\b | \\b\\d+([Ee][+-]?\\d+)\\b | \\b\\d+([Ee][+-]?\\d+)?\\b | \\b\\d+(?!,)\\b ) (?!\\$)",
			"name": "constant.numeric.decimal.btv"
		},		
		"id_molde": {
			"match": "\\b(?<=molde|se\\s+passa\\s+por)\\s+[A-Z][a-zA-Z]*(?=\\s+(se|contem)|\\s*(;|\\.))",
			"name": "entity.name.type.id.molde.btv"
		},
		"id": {
			"match": "\\b[a-z][a-zA-Z]*(?=\\s*(;|\\())",
			"name": "entity.name.type.id.btv"
		}
	}
}